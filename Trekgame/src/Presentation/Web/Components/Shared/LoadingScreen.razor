@* Professional Loading Screen Component with Star Trek theming *@

<div class="loading-overlay @(IsVisible ? "visible" : "")">
    <div class="loading-content">
        @* Animated starfield background *@
        <div class="loading-stars">
            @for (int i = 0; i < 50; i++)
            {
                <div class="star" style="@GetStarStyle(i)"></div>
            }
        </div>
        
        @* Central loading indicator *@
        <div class="loading-center">
            @* Warp effect rings *@
            <div class="warp-ring ring-1"></div>
            <div class="warp-ring ring-2"></div>
            <div class="warp-ring ring-3"></div>
            
            @* Central emblem *@
            <div class="loading-emblem">
                @if (!string.IsNullOrEmpty(FactionId))
                {
                    <StarTrekGame.Web.Components.Shared.FactionEmblem RaceId="@FactionId" Size="large" />
                }
                else
                {
                    <div class="default-emblem">â˜…</div>
                }
            </div>
        </div>
        
        @* Loading text *@
        <div class="loading-text">
            <h2 class="loading-title">@Title</h2>
            <p class="loading-message">@Message</p>
            
            @* Progress bar (optional) *@
            @if (ShowProgress)
            {
                <div class="loading-progress">
                    <div class="progress-track">
                        <div class="progress-fill" style="width: @(Progress)%;"></div>
                    </div>
                    <span class="progress-text">@Progress%</span>
                </div>
            }
            
            @* Animated dots *@
            <div class="loading-dots">
                <span>.</span><span>.</span><span>.</span>
            </div>
        </div>
        
        @* Tip text *@
        @if (!string.IsNullOrEmpty(Tip))
        {
            <div class="loading-tip">
                <span class="tip-label">TIP:</span> @Tip
            </div>
        }
    </div>
</div>

@code {
    [Parameter] public bool IsVisible { get; set; } = true;
    [Parameter] public string Title { get; set; } = "LOADING";
    [Parameter] public string Message { get; set; } = "Initializing systems";
    [Parameter] public string? Tip { get; set; }
    [Parameter] public string? FactionId { get; set; }
    [Parameter] public bool ShowProgress { get; set; } = false;
    [Parameter] public int Progress { get; set; } = 0;

    private Random _rand = new Random(42);

    private string GetStarStyle(int index)
    {
        var x = _rand.Next(100);
        var y = _rand.Next(100);
        var size = _rand.NextDouble() * 2 + 1;
        var delay = _rand.NextDouble() * 3;
        var duration = _rand.NextDouble() * 2 + 1;
        return $"left: {x}%; top: {y}%; width: {size}px; height: {size}px; animation-delay: {delay}s; animation-duration: {duration}s;";
    }

    private static readonly string[] Tips = new[]
    {
        "Diplomatic relations take time to develop. Be patient with new contacts.",
        "Experienced crews perform better in combat than raw numbers.",
        "Scout ships are essential for exploring new territories safely.",
        "A well-positioned fleet can defeat a larger force.",
        "Research unlocks new ship designs and colony buildings.",
        "Trade routes generate passive income between colonies.",
        "Defensive positions grant significant combat bonuses.",
        "Monitor your supply lines - distant fleets need logistical support.",
    };

    protected override void OnInitialized()
    {
        if (string.IsNullOrEmpty(Tip))
        {
            Tip = Tips[new Random().Next(Tips.Length)];
        }
    }
}

<style>
    .loading-overlay {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        background: linear-gradient(180deg, #030010 0%, #0a0020 50%, #100818 100%);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.5s, visibility 0.5s;
    }

    .loading-overlay.visible {
        opacity: 1;
        visibility: visible;
    }

    .loading-content {
        text-align: center;
        position: relative;
        z-index: 1;
    }

    /* Starfield */
    .loading-stars {
        position: fixed;
        top: 0; left: 0; right: 0; bottom: 0;
        overflow: hidden;
    }

    .star {
        position: absolute;
        background: white;
        border-radius: 50%;
        animation: star-twinkle 2s ease-in-out infinite;
    }

    @@keyframes star-twinkle {
        0%, 100% { opacity: 0.3; }
        50% { opacity: 1; }
    }

    /* Warp rings */
    .loading-center {
        position: relative;
        width: 200px;
        height: 200px;
        margin: 0 auto 40px;
    }

    .warp-ring {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        border: 2px solid var(--theme-primary, #ff9900);
        border-radius: 50%;
        opacity: 0;
        animation: warp-pulse 3s ease-out infinite;
    }

    .ring-1 { width: 80px; height: 80px; animation-delay: 0s; }
    .ring-2 { width: 120px; height: 120px; animation-delay: 0.5s; }
    .ring-3 { width: 160px; height: 160px; animation-delay: 1s; }

    @@keyframes warp-pulse {
        0% { transform: translate(-50%, -50%) scale(0.5); opacity: 1; }
        100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
    }

    .loading-emblem {
        position: absolute;
        top: 50%; left: 50%;
        transform: translate(-50%, -50%);
        z-index: 2;
    }

    .default-emblem {
        width: 72px;
        height: 72px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 48px;
        color: var(--theme-primary, #ff9900);
        text-shadow: 0 0 20px var(--theme-primary, #ff9900);
        animation: emblem-glow 2s ease-in-out infinite;
    }

    @@keyframes emblem-glow {
        0%, 100% { text-shadow: 0 0 20px var(--theme-primary, #ff9900); }
        50% { text-shadow: 0 0 40px var(--theme-primary, #ff9900), 0 0 60px var(--theme-primary, #ff9900); }
    }

    /* Text */
    .loading-text {
        color: white;
    }

    .loading-title {
        font-family: 'Orbitron', sans-serif;
        font-size: 32px;
        font-weight: 700;
        letter-spacing: 8px;
        color: var(--theme-accent, #ffcc00);
        margin: 0 0 8px;
        text-shadow: 0 0 20px var(--theme-accent, #ffcc00);
    }

    .loading-message {
        font-size: 16px;
        color: #88aacc;
        margin: 0;
        letter-spacing: 2px;
    }

    /* Progress */
    .loading-progress {
        margin-top: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
    }

    .progress-track {
        width: 200px;
        height: 4px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 2px;
        overflow: hidden;
    }

    .progress-fill {
        height: 100%;
        background: linear-gradient(90deg, var(--theme-primary, #ff9900), var(--theme-accent, #ffcc00));
        border-radius: 2px;
        transition: width 0.3s ease;
    }

    .progress-text {
        font-size: 12px;
        color: var(--theme-primary, #ff9900);
        font-family: monospace;
    }

    /* Dots animation */
    .loading-dots {
        margin-top: 16px;
    }

    .loading-dots span {
        display: inline-block;
        font-size: 24px;
        color: var(--theme-primary, #ff9900);
        animation: dot-bounce 1.4s ease-in-out infinite;
    }

    .loading-dots span:nth-child(1) { animation-delay: 0s; }
    .loading-dots span:nth-child(2) { animation-delay: 0.2s; }
    .loading-dots span:nth-child(3) { animation-delay: 0.4s; }

    @@keyframes dot-bounce {
        0%, 80%, 100% { transform: translateY(0); }
        40% { transform: translateY(-10px); }
    }

    /* Tip */
    .loading-tip {
        position: fixed;
        bottom: 40px;
        left: 50%;
        transform: translateX(-50%);
        max-width: 600px;
        padding: 16px 24px;
        background: rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 8px;
        color: #888;
        font-size: 14px;
    }

    .tip-label {
        color: var(--theme-primary, #ff9900);
        font-weight: 700;
        margin-right: 8px;
    }
</style>
